import{_ as T,k as S,c as l,P as d,m as f,q as p,C as B,L,a as s,e,n as D,s as h,t as v,F as k,r as E,b,u as N,g as C,d as o,v as A,A as i,p as P,f as j,h as I}from"./index.b7b95059.js";import{a as y}from"./AttendeesService.266d462f.js";const V={setup(){const a=N(),r=A();async function w(){try{const n=a.params.eventId;await p.getTowerEventById(n)}catch{d.error("getting event by id"),r.push("/")}}async function t(){try{const n=a.params.eventId;await y.getTicketsByEventId(n)}catch(n){d.error(n.message)}}async function g(){try{const n=a.params.eventId;await f.getCommentsByEventId(n)}catch(n){d.error(n.message)}}return S(()=>{a.params.eventId&&(w(),t(),g())}),{towerEvent:l(()=>i.currentEvent),account:l(()=>i.account),tickets:l(()=>i.tickets),foundTicket:l(()=>i.attendees.find(n=>n.id==i.account.id)),myTicket:l(()=>i.attendees.find(n=>n.eventId==i.currentEvent.id)),attendees:l(()=>i.attendees),comments:l(()=>i.comments),isCancelled:l(()=>i.towerEvents.isCanceled),async createTicket(){try{await y.createTicket({eventId:a.params.eventId})}catch(n){d.error(n.message)}},async removeTicket(n){try{await y.removeTicket(n)}catch(_){d.error(_.message)}},async deleteComment(n){try{await d.confirm()&&await f.deleteComment(n)}catch(_){d.error(_)}},async cancelTowerEvent(n){try{await d.confirm("Are you sure you want to cancel this event?","You will not be able to undo this","Confirm Cancel")&&await p.cancelTowerEvent(n)}catch(_){d.error(_.mesasge)}}}},components:{Comment:B,Loading:L}},m=a=>(P("data-v-a473e794"),a=a(),j(),a),F={key:0,class:"container-fluid bg-dark"},R={class:"row"},q={class:"card-body"},z={class:"row"},W={class:"col-4"},Y={key:0},G=m(()=>e("i",{class:"mdi mdi-close-circle"},"Cancel Event",-1)),H=[G],J={key:1},K=m(()=>e("button",{class:"btn btn-danger",disabled:""},"Event Cancelled",-1)),M=[K],O={class:"col-8 mt-5"},Q={class:"glass-card"},U={class:"d-flex justify-content-between"},X={class:"card-title"},Z={class:"card-text"},$={class:"d-flex justify-content-between align-items-end mt-5"},ee=["disabled"],te={key:0,class:"p-0 m-0"},ne=I("Attend "),se=m(()=>e("i",{class:"mdi mdi-human"},null,-1)),oe=[ne,se],ce={key:1,class:"p-0 m-0 text-decoration-line-through"},ae=["disabled"],ie=I(" Not Attend "),de=m(()=>e("i",{class:"mdi mdi-run"},null,-1)),re=[ie,de],le={class:"row"},_e=m(()=>e("div",{class:"col-12 bg-primary pt-2"},[e("p",{class:"m-0 p-0 text-dark"},"See who's attending")],-1)),ve={class:"col-12 m-auto d-flex flex-row bg-primary p-2"},me={class:"row"},he={class:"col-12 d-flex"},ue=["src","title"],ye={class:"row"},we={class:"col-9 m-auto mt-2"},ge={class:"card p-3 bg-light text-light"},fe=m(()=>e("p",{class:"text-dark"},"What people are saying",-1)),pe={class:"mt-3"},ke={class:"row pe-3"},Ee={class:"col-2 d-flex justify-content-center"},be=["src","alt"],Ce={class:"col-10 bg-white text-dark rounded"},Ie={class:"d-flex justify-content-between align-items-center pt-1"},xe=["onClick"],Te={class:"ps-3"},Se={key:1};function Be(a,r,w,t,g,n){const _=C("Comment"),x=C("Loading");return t.towerEvent?(o(),s("div",F,[e("div",R,[e("div",{class:"eventCard card text-start img-fluid text-light",id:"header",style:D({backgroundImage:`url('${t.towerEvent.coverImg}')`})},[e("div",q,[e("div",z,[e("div",W,[t.towerEvent.creatorId==t.account.id&&t.towerEvent.isCancelled===!1?(o(),s("div",Y,[e("button",{class:"btn btn-danger",onClick:r[0]||(r[0]=c=>t.cancelTowerEvent(t.towerEvent.id))},H)])):h("",!0),t.towerEvent.isCancelled==!0?(o(),s("div",J,M)):h("",!0)]),e("div",O,[e("div",Q,[e("span",U,[e("span",null,[e("h1",X,v(t.towerEvent.name),1),e("h5",null,v(t.towerEvent.location),1)]),e("h3",null,"Starts "+v(new Date(t.towerEvent.startDate).toLocaleDateString()),1)]),e("p",Z,v(t.towerEvent.description),1),e("span",$,[e("h4",null,v(t.towerEvent.capacity)+" Spots Left",1),e("div",null,[t.foundTicket?(o(),s("button",{key:1,onClick:r[2]||(r[2]=c=>{var u;return t.removeTicket((u=t.myTicket)==null?void 0:u.attendeeId)}),disabled:t.towerEvent.isCancelled,class:"btn btn-danger elevation-1"},re,8,ae)):(o(),s("button",{key:0,onClick:r[1]||(r[1]=c=>t.createTicket()),disabled:t.towerEvent.isCancelled||t.towerEvent.capacity==0,class:"btn btn-info elevation-1"},[t.towerEvent.capacity!=0?(o(),s("p",te,oe)):h("",!0),t.towerEvent.capacity<=0?(o(),s("p",ce,"No Tickets Left")):h("",!0)],8,ee))])])])])])])],4)]),e("div",le,[_e,e("div",ve,[e("div",me,[e("div",he,[(o(!0),s(k,null,E(t.attendees,c=>(o(),s("div",null,[e("img",{class:"attendee img-fluid rounded-circle p-1",src:c.picture,alt:"",title:c.name},null,8,ue)]))),256))])])])]),e("div",ye,[e("div",we,[e("div",ge,[fe,b(_,{eventId:t.towerEvent.id},null,8,["eventId"]),(o(!0),s(k,null,E(t.comments,c=>(o(),s("div",pe,[e("div",ke,[e("div",Ee,[e("img",{class:"rounded-circle profilePic text-center p-0 m-0",src:c.creator.picture,alt:c.creator.name},null,8,be)]),e("div",Ce,[e("div",Ie,[e("h5",null,v(c.creator.name),1),c.creatorId==t.account.id?(o(),s("i",{key:0,onClick:u=>t.deleteComment(c.id),class:"mdi mdi-delete-outline fs-5 selectable",title:"Delete Comment",style:{color:"red"}},null,8,xe)):h("",!0)]),e("div",null,[e("p",Te,v(c.body),1)])])])]))),256))])])])])):(o(),s("div",Se,[b(x)]))}const Ne=T(V,[["render",Be],["__scopeId","data-v-a473e794"]]);export{Ne as default};
